<?php

namespace VPlugins\MalwareScanner\Admin;

use VPlugins\MalwareScanner\Core\Helper;

class AdminPage {

    /**
     * Register admin menu and submenu pages.
     */
    public function register() {
        add_action('admin_menu', [$this, 'add_admin_menu']);
    }

    /**
     * Add the admin menu and submenu pages.
     */
    public function add_admin_menu() {
        add_menu_page(
            'Malware Scanner',
            'Malware Scanner',
            'manage_options',
            'malware-scanner',
            [$this, 'render_main_page'],
            'dashicons-shield'
        );

        add_submenu_page(
            'malware-scanner',
            'Scanner',
            'Scanner',
            'manage_options',
            'malware-scanner-scanner',
            [$this, 'render_scanner_page']
        );

        add_submenu_page(
            'malware-scanner',
            'Yara Rules',
            'Yara Rules',
            'manage_options',
            'malware-scanner-yara-rules',
            [$this, 'render_yara_rules_page']
        );

        add_submenu_page(
            'malware-scanner',
            'Schedule',
            'Schedule',
            'manage_options',
            'malware-scanner-schedule',
            [$this, 'render_schedule_page']
        );

        add_submenu_page(
            'malware-scanner',
            'Settings',
            'Settings',
            'manage_options',
            'malware-scanner-settings',
            [$this, 'render_settings_page']
        );
    }

    /**
     * Render the main page content.
     */
    public function render_main_page() {
        include plugin_dir_path(__FILE__) . 'views/main.php';
    }

    /**
     * Render the Scanner page content.
     */
    public function render_scanner_page() {
        include plugin_dir_path(__FILE__) . 'views/scanner.php';
    }

    /**
     * Render the Yara Rules page content.
     */
    public function render_yara_rules_page() {
        include plugin_dir_path(__FILE__) . 'views/yara_rules.php';
    }

    /**
     * Render the Schedule page content.
     */
    public function render_schedule_page() {
        include plugin_dir_path(__FILE__) . 'views/schedule.php';
    }

    /**
     * Render the Settings page content.
     */
    public function render_settings_page() {
        include plugin_dir_path(__FILE__) . 'views/settings.php';
    }
}